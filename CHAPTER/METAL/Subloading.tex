\section{Extended Subloading Surface Model}\label{sec:subloading}
The model is published \cite{Chang2025}.
\subsection{Subloading Surface}
Conventional plasticity models often adopt the concept of a yield surface, denoted by $f\left(\bsigma,\cdots\right)$, which defines the frontier/boundary of plasticity.
For example,
\begin{gather}
    f=\norm{\beeta}-F,
\end{gather}
in which $\beeta=\beeta\left(\bsigma,\cdots\right)$ is known as the shifted stress that shall be a function of the stress tensor $\bsigma$ and other internal variables, $F=F\left(q\right)$ characterises the size of this surface and could evolve with the development of plasticity driven by some internal variable $q$.
Within the yield surface $f$, the material is elastic, while plasticity would develop once the stress state reaches and exceeds $f$, in which case, the surface itself would also expand to enclose the current stress state accordingly.
Thus, any admissible state shall satisfy the inequality $f\leqslant0$.

The original proposal of the subloading surface model introduces a new internal variable, named as the normal yield ratio, denoted by $z$ in this work, which effectively scales the yield surface $f$ down by a factor $z$, the new surface is call the subloading surface $f_s$ and it is concentric with the yield surface $f$.
\begin{gather}
    f_s=\norm{\beeta}-zF.
\end{gather}
The normal yield ratio $0\leqslant{}z\leqslant{}1$ shall be updated in a manner such that $f_s=0$ is enforced not only for plastic loading but also for elastic unloading.
With such a construct, any given stress state would always lie on the subloading surface, meaning that $f_s=0$ is always satisfied.

The main shortcoming of the original subloading surface model is that it exhibits excessive strain accumulation under cyclic loading.
To address this issue, an additional internal field, denoted by $\bc$, is adopted to define the elastic core surface in the extended subloading surface model, which is concentric with the yield surface (centred at the back stress $\bbeta$).
The subloading surface is then pulled from the original centre $\bbeta$ towards $\bc$ by a certain amount governed by the normal yield ratio $z$.
\begin{figure}[htb]
    \centering
    \begin{tikzpicture}[>=latex]
        \newcommand{\FF}{4}
        \newcommand{\SF}{2.5}
        \draw[->](-.5,0)--(3,0);
        \draw[->](0,-.5)--(0,3);
        \coordinate(A)at(2.8,3);
        \coordinate(B)at($(A)+(10:3)$);
        \coordinate(C)at($(B)!\SF/\FF!(A)$);
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(A){};
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(B){};
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(C){};
        \draw[dashed,draw,line width=.3mm](A)circle(\FF);
        \draw[dotted,draw,line width=.3mm](A)circle(\SF);
        \draw[draw,line width=.6mm](C)circle(\SF);
        \draw[->,d73027,line width=.4mm](0,0)--(A)node[midway,fill=white,sloped]{$\bbeta$};
        \draw[->,d73027,line width=.6mm](A)--(B);
        \draw[->,d73027,line width=.4mm](0,0)--(B)node[midway,fill=white,sloped]{$\bc$};
        \draw[->,4575b4,line width=.8mm](A)--(C);
        \draw[|<->|](A)--++(140:\FF)node[midway,fill=white,sloped]{$F$};
        \draw[|<->|](C)--++(140:\SF)node[midway,fill=white,sloped]{$zF$};
        \draw[<-]($(A)+(60:\FF)$)--++(60:1.4)--++(1,0)node[right,fill=white]{yield surface $f$};
        \draw[<-]($(A)+(60:\SF)$)--++(60:.8)--++(2,0)node[right,fill=white,align=left]{subloading surface\\in the original proposal};
        \draw[<-]($(C)+(60:\SF)$)--++(60:1.8)--++(1,0)node[right,fill=white,align=left]{subloading surface\\in the extended version};
        \draw[<-]($(C)!.5!(B)$)--++(-60:1.5)--++(2,0)node[right,fill=white]{$z\left(\bc-\bbeta\right)$};
        \draw[<-]($(A)!.5!(C)$)--++(-60:2)--++(2.5,0)node[right,fill=white]{$\left(1-z\right)\left(\bc-\bbeta\right)$};
        \draw[black!20]($(A)+(140:\FF)$)--(B);
    \end{tikzpicture}
    \caption{graphical representation of the surfaces used in the subloading surface model}\label{fig:surfaces}
\end{figure}
A graphical illustration is shown in \figref{fig:surfaces}.
By definition, $\bc$ denotes the homothetic centre between $f$ and $f_s$.
Then, according to similarity, the new centre of the subloading surface is $\bbeta+\left(1-z\right)\left(\bc-\bbeta\right)$, that is $z\bbeta+\left(1-z\right)\bc$.
\subsection{Original Evolution Rules}
The evolution rule for the elastic core has undergone several iterations, see, for example, the initial version \cite{Hashiguchi1989}, one of the variations \cite{Hashiguchi2015}, the most recent version \cite{Anjiki2019}.
The original formulation further imposes the requirement that the size of the elastic core shall be limited to a certain fraction of that of the yield surface.
This is achieved by the following evolution rule for $\bc$ \cite{Anjiki2019,Hashiguchi2023},
\begin{gather}\label{eq:original_core}
    \dot{\bc}=c_e\norm{\dot{\bvarepsilon^p}}\left(z_eF\bn-\left(\bc-\bbeta\right)\right)+\dot{\bbeta}+\dfrac{\dot{F}}{F}\left(\bc-\bbeta\right).
\end{gather}
In which, $0\leqslant{}c_e$ is a constant that controls the evolution rate, $0\leqslant{}z_e\leqslant1$ is a constant that controls the limit size of the elastic core and $\bn=\pdfrac{f_s}{\bsigma}/\norm{\pdfrac{f_s}{\bsigma}}=\dfrac{\beeta}{\norm{\beeta}}$ is unit gradient of the subloading surface.
It shall be pointed out that the term $z_eF\bn$ is expressed as $z_e\dfrac{\beeta}{z}$ in the original formulation.
They are identical due to the fact that $\norm{\beeta}=zF$ since $f_s\equiv0$ while $F\bn$ has clear numerical advantages over $\dfrac{\beeta}{z}$.

The evolution rule for the normal yield ratio $z$ is given by
\begin{gather}\label{eq:original_z}
    \dot{z}=U\dot{q},
\end{gather}
where $U=U\left(z\right)$ is a function that shall satisfy certain conditions, and $q$ is the accumulated plastic strain.

Both of the above evolution rules will be discussed and refined in the following sections.
Here, we only present them in their original forms for completeness.
\subsection{Revisions}\label{sec:revised}
\subsubsection{Preliminary Remarks}
In the scalar form, the Armstrong--Frederick evolution rule \cite{Frederick2007} is equivalent to the following ordinary differential equation (ODE),
\begin{gather}\label{eq:af_ode}
    y'=b\left(a-y\right),
\end{gather}
it can be explicitly integrated to give the solution for the initial condition $y(0)=0$,
\begin{gather}
    y(x)=a\left(1-\exp\left(-bx\right)\right),
\end{gather}
which defines a curve that asymptotically approaches the constant bound $a$.

To employ a non-constant bound, it is possible to simply replace the constant $a$ by a function $a(x)$ in the ODE \eqsref{eq:af_ode} such that $y'=b\left(a\left(x\right)-y\right)$.
However, as noted in the literature, the corresponding solution is not strictly bounded by $a(x)$.
\figref{fig:examples} presents both hardening and softening examples to illustrate this point.
\begin{figure}[htb]
    \centering
    \begin{subfigure}{.48\textwidth}
        \centering
        \begin{tikzpicture}
            \begin{axis}[axis lines=middle,xlabel=$x$,ylabel=$y$,grid=both,width=6.5cm,height=4.5cm,legend pos=south east,ymin=0,ymax=1.5,scale only axis,enlargelimits=false]
                \pgfmathsetmacro{\aa}{-.05}
                \pgfmathsetmacro{\bb}{1}
                \addplot[line width=2pt,dashed,domain=0:10,samples=100,color=fc8d59]{\aa*x+\bb};
                \addplot[line width=1pt,domain=0:10,samples=100,color=d73027]{\aa*x+\bb+(\aa-\bb)*exp(-x)-\aa};
                \addlegendentry{$a(x)=\aa{}x+\bb$}
                \addlegendentry{$\dot{y}=a(x)-y$}
                \addlegendentry{$\dot{y}=1-y/a(x)$}
            \end{axis}
        \end{tikzpicture}
        \caption{softening}
    \end{subfigure}\hfill
    \begin{subfigure}{.48\textwidth}
        \centering
        \begin{tikzpicture}
            \begin{axis}[axis lines=middle,xlabel=$x$,ylabel=$y$,grid=both,width=6.5cm,height=4.5cm,legend pos=south east,ymin=0,ymax=1.5,scale only axis,enlargelimits=false]
                \pgfmathsetmacro{\aa}{0.05}
                \pgfmathsetmacro{\bb}{1}
                \addplot[line width=2pt,dashed,domain=0:10,samples=100,color=fc8d59]{\aa*x+\bb};
                \addplot[line width=1pt,domain=0:10,samples=100,color=d73027]{\aa*x+\bb+(\aa-\bb)*exp(-x)-\aa};
                \addlegendentry{$a(x)=\aa{}x+\bb$}
                \addlegendentry{$\dot{y}=a(x)-y$}
                \addlegendentry{$\dot{y}=1-y/a(x)$}
            \end{axis}
        \end{tikzpicture}
        \caption{hardening}
    \end{subfigure}
    \caption{asymptotic behaviour with hardening and softening bounds}\label{fig:examples}
\end{figure}
As can be seen from the figure, the solution may overshoot for softening bounds.
Furthermore, in both cases, the solution $y$ does \textbf{not} asymptotically approach the bound $a(x)$.
That is, the following condition does not hold for arbitrarily small $\epsilon$,
\begin{gather}
    \lim\limits_{x\to\infty}\abs{y-a(x)}<\epsilon.
\end{gather}
It is worth noting that the following form
\begin{gather}
    y'=b\left(1-\dfrac{1}{a\left(x\right)}y\right)=\dfrac{b}{a\left(x\right)}\left(a\left(x\right)-y\right)
\end{gather}
has a similar solution to that of $y'=b\left(a\left(x\right)-y\right)$.
The $y'$ is governed by the difference $a\left(x\right)-y$, while the approaching rate changes from $b$ to $b/a\left(x\right)$.
They are equivalent in terms of the asymptotic behaviour and share the same shortcoming.
This form has been used in defining the evolution rule for the back stress in the subloading surface model \cite{Anjiki2019,Hashiguchi2023,Hashiguchi2024}.

To ensure that the solution is bounded by $a(x)$, let's consider the following function,
\begin{gather}\label{eq:strict_bound_core}
    y=a(x)\left(1-\exp\left(-bx\right)\right),
\end{gather}
since $1-\exp\left(-bx\right)<1$, it is guaranteed that $y<a(x)$.
On the other hand, the corresponding ODE can be derived as follows,
\begin{gather}\label{eq:strict_bound}
    y'=ab\exp\left(-bx\right)+a'\left(1-\exp\left(-bx\right)\right)=b\left(a-y\right)+\dfrac{a'}{a}y.
\end{gather}
After careful comparison, one could observe that \eqsref{eq:strict_bound} is in fact the scalar unidirectional version of the evolution rule presented in \eqsref{eq:original_core}.
They bear the same format.
Thus, one can conclude that \eqsref{eq:strict_bound_core} is mathematically equivalent to \eqsref{eq:strict_bound} as it is the solution to the latter with the initial condition $y(0)=0$, however, the latter is much more cumbersome.

On the other hand, consider the function
\begin{gather}\label{eq:polar_decomposition}
    \bc-\bbeta=F\bd,
\end{gather}
in which $\bd$ is some quantity, its derivative can be expressed as
\begin{gather}
    \dot{\bc}-\dot{\bbeta}=F\dot{\bd}+\dot{F}\bd=F\dot{\bd}+\dfrac{\dot{F}}{F}\left(\bc-\bbeta\right).
\end{gather}
By comparing with \eqsref{eq:original_core}, one could conclude that \eqsref{eq:polar_decomposition} must be mathematically equivalent to \eqsref{eq:original_core} if $\bd$ is governed by the following evolution rule,
\begin{gather}
    \dot{\bd}=c_e\norm{\dot{\bvarepsilon^p}}\left(z_e\bn-\bd\right).
\end{gather}
If the associative flow rule is adopted, the above expression to be further expressed as
\begin{gather}
    \dot{\bd}=c_e\left(z_e\dot{\bvarepsilon^p}-\norm{\dot{\bvarepsilon^p}}\bd\right).
\end{gather}
This is effectively an Armstrong--Frederick type evolution rule for $\bd$.
\subsubsection{Revised Evolution Rule (Elastic Core)}
The evolution rule for $\bc$ shown in \eqsref{eq:original_core} is derived at the limit state where the subloading surface coincides with the limit surface --- which would not occur due to its asymptotic nature.
It possesses a cumbersome form that involves both $F$ and its derivative.
As a result, it is not straightforward to implement numerically.
Instead, based on the above observations, one can apply the following decomposition,
\begin{gather}\label{eq:decomposition_core}
    \boxed{\bc-\bbeta=F\bd\qquad\rightarrow\qquad\bc=\bbeta+F\bd,}
\end{gather}
then the evolution of $\bc$, which characterises a point on the elastic core surface, can be equivalently described by the evolution of $\bd$, which could take a very simple form as the contribution of $F$ is separated,
\begin{gather}\label{eq:revised_core}
    \boxed{\dot{\bd}=c_e\left(z_e\dot{\bvarepsilon^p}-\norm{\dot{\bvarepsilon^p}}\bd\right).}
\end{gather}
Since the magnitude of $\bd$ defined in this manner is bounded by the constant $z_e$, it is then guaranteed that $\norm{\bc-\bbeta}=F\norm{\bd}<z_eF$.
Based on the above discussion, it can be asserted that \eqsref{eq:decomposition_core} with \eqsref{eq:revised_core} is mathematically equivalent to \eqsref{eq:original_core}.
However, such a decomposition separates the directional vector from the scalar magnitude, which allows much simpler evolution rules for both parts, although the vector here is not a unit vector thus does not possess a fixed unit length.
\eqsref{eq:decomposition_core} may be called the `\textit{pseudo-polar coordinate}' representation while $\bd$ may be called the `\textit{similarity vector}' as it points to the similarity centre $\bc$.
\subsubsection{Revised Evolution Rule (Back Stress)}
Now since \eqsref{eq:decomposition_core} is adopted, a similar strategy can also be applied to $\bbeta$ to allow its bound to evolve with the development of plasticity, that is,
\begin{gather}\label{eq:decomposition_back}
    \boxed{\bbeta=H\balpha,}
\end{gather}
with $H=H\left(q\right)$ being the bound and $\balpha$ being the normalised back stress (normalised by $H$) which could have the following evolution rule.
\begin{gather}\label{eq:revised_back}
    \boxed{\dot{\balpha}=b\left(\dot{\bvarepsilon^p}-\norm{\dot{\bvarepsilon^p}}\balpha\right),}
\end{gather}
where $b$ is a constant that controls the evolution rate.
Similar to $\norm{\bc-\bbeta}$, here it is guaranteed that $\norm{\bbeta}=H\norm{\balpha}<H$ as $\norm{\balpha}<1$.

It is possible to set $H$ to a fraction of $F$.
Here, to allow more flexibility, $H$ is defined as an independent quantity.
Nevertheless, if one wishes, it is possible to associate $H$ with $F$ as done in other work \cite{Anjiki2019}.
However, one shall note that the specific form $\bbeta=b\left(\dot{\bvarepsilon^p}-\norm{\dot{\bvarepsilon^p}}\dfrac{\bbeta}{H}\right)$, which is used by \cite{Anjiki2019,Anjiki2021}, shall not be used as the back stress may go beyond the intended bound ($\norm{\bbeta}>H$) for softening materials, see the discussion around \figref{fig:examples}.
\subsubsection{Shifted Stress}
Since now the new centre of the subloading surface is shifted to $\bbeta+\left(1-z\right)\left(\bc-\bbeta\right)$, the original formulation uses the following expression to compute the shifted stress $\beeta$,
\begin{gather}
    \beeta=\bs-\left(\bbeta+\left(1-z\right)\left(\bc-\bbeta\right)\right),
\end{gather}
where $\bs=\bs\left(\bsigma\right)$ is some function of the stress tensor $\bsigma$.
Account for the proposed decompositions \eqsref{eq:decomposition_core} and \eqsref{eq:decomposition_back}, the above expression can be rewritten as
\begin{gather}
    \boxed{\beeta=\bs-H\balpha+\left(z-1\right)F\bd,}
\end{gather}
\figref{fig:revised_surfaces} presents a graphical representation of the quantities used in this revised formulation.
\begin{figure}[htb]
    \centering
    \begin{tikzpicture}[>=latex]
        \newcommand{\DD}{80}
        \newcommand{\FF}{4}
        \newcommand{\SF}{2.5}
        \draw[->](-.5,0)--(3,0);
        \draw[->](0,-.5)--(0,3);
        \coordinate(A)at(2.8,.4);
        \coordinate(B)at($(A)+(30:3)$);
        \coordinate(C)at($(B)!\SF/\FF!(A)$);
        \coordinate(D)at($(C)+(\DD:\SF)$);
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(A){};
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(B){};
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(C){};
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(D){};
        \draw[dashed,draw,line width=.3mm](A)circle(\FF);
        \draw[draw,line width=.6mm](C)circle(\SF);
        \draw[->,d73027,line width=1mm](0,0)--(A)node[midway,fill=white,sloped]{$\bbeta=H\balpha$};
        \draw[->,dotted,d73027,line width=.4mm](C)--(B);
        \draw[->,d73027,line width=1mm](A)--(C);
        \draw[->,d73027,line width=1mm](C)--(D)node[midway,fill=white]{$\beeta$};
        \draw[->,d73027,line width=1mm](0,0)--(D)node[midway,fill=white,sloped]{$\bs$};
        \draw[|<->|](C)--++(50:\SF)node[midway,fill=white,sloped]{$zF$};
        \draw[<-]($(A)+(60:\FF)$)--++(60:1.4)--++(1,0)node[right,fill=white]{yield surface $f$};
        \draw[<-]($(C)+(60:\SF)$)--++(60:1.7)--++(1,0)node[right,fill=white]{subloading surface};
        \draw[<-]($(C)!.5!(B)$)--++(-60:1.5)--++(2,0)node[right,fill=white]{$zF\bd$};
        \draw[<-]($(A)!.5!(C)$)--++(-60:2)--++(2.5,0)node[right,fill=white]{$\left(1-z\right)F\bd$};
    \end{tikzpicture}
    \caption{graphical representation of the surfaces using proposed definitions}\label{fig:revised_surfaces}
\end{figure}
It could also be noted that, since $\norm{\bd}<1$, then $\norm{zF\bd}<zF$, the homothetic centre is always inside the subloading surface $f_s$, which itself is inside the yield surface $f$.
\subsection{Loading/Unloading Criterion}\label{sec:correct_loading_criterion}
The conventional Kuhn--Tucker condition cannot be applied in the subloading surface model since, even for elastic unloading, the history variable $z$ shall be updated for every load increment/step.
For arbitrary loading directions and magnitudes, there exists possibilities that the normal yield ratio $z$ may decrease first --- the subloading surface shrinks, then increase --- the subloading surface expands.
When it expands, the plasticity can only be correctly computed with the correct initial value of $z$.
An inward load increment resulting in $f_s^\text{trial}<0$ does not necessarily imply that it is a pure elastic unloading step.
A graphical representation is shown in \figref{fig:loading_criterion}.
\begin{figure}[htb]
    \centering
    \begin{tikzpicture}[>=latex]
        \newcommand{\DD}{70}
        \newcommand{\FF}{4}
        \newcommand{\SF}{2.5}
        \newcommand{\BF}{3.3}
        \newcommand{\LF}{1.7}
        \draw[->](-.5,0)--(2,0);
        \draw[->](0,-.5)--(0,2);
        % yield surface
        \coordinate(A)at(2.8,3);
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(A){};
        \draw[dashed,draw,line width=.3mm](A)circle(\FF);
        \draw[<-]($(A)+(60:\FF)$)--++(60:1.4)--++(1,0)node[right,fill=white]{yield surface $f$};
        % similarity centre
        \coordinate(B)at($(A)+(10:3)$);
        \draw[black!40](B)--($(A)+(\DD:\FF)$);
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(B){};
        \draw[dotted,d73027,line width=.4mm]($(B)!2.5!(A)$)--($(A)!1.5!(B)$)node[black,right,align=left]{centre of the subloading\\surface must lie on this\\fixed line};
        % current subloading surface
        \coordinate(C)at($(B)!\SF/\FF!(A)$);
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(C){};
        \draw[draw,line width=.6mm](C)circle(\SF);
        \draw[<-]($(C)+(60:\SF)$)--++(60:1.7)--++(.5,0)node[right,fill=white]{current subloading surface};
        \coordinate(D)at($(C)+(\DD:\SF)$);
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(D){};
        % bigger subloading surface
        \coordinate(CB)at($(B)!\BF/\FF!(A)$);
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(CB){};
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at($(CB)+(\DD:\BF)$){};
        \draw[|<->|](CB)--++(\DD:\BF)node[midway,fill=white,sloped]{$z\uparrow$};
        \draw[black!40,draw,line width=.6mm](CB)circle(\BF);
        % smaller subloading surface
        \coordinate(CS)at($(B)!\LF/\FF!(A)$);
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(CS){};
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at($(CS)+(\DD:\LF)$){};
        \draw[|<->|](CS)--++(\DD:\LF)node[midway,fill=white,sloped]{$z\downarrow$};
        \draw[black!40,draw,line width=.6mm](CS)circle(\LF);
        % arrows
        \draw[->,d73027,line width=1mm](0,0)--(A)node[midway,fill=white,sloped]{$\bbeta=H\balpha$};
        \draw[->,d73027,line width=1mm](A)--(C);
        \draw[->,d73027,line width=1mm](C)--(D)node[midway,fill=white,sloped]{$\beeta$};
        \draw[<-]($(A)!0.3!(C)$)--++(-60:2)--++(2.5,0)node[right,fill=white]{$\left(1-z\right)F\bd$};
        \draw[dotted,line width=.4mm]($(D)+(180:6)$)--($(D)+(0:2)$)node[right,align=left]{search along the loading\\direction to minimise $z$};
        \draw[->,4575b4,line width=1mm](D)--++(180:2.8)node[fill=black,circle,inner sep=0,minimum size=2mm]{};
        \draw[<-]($(D)+(180:2)$)--++(135:2.5)--++(-1,0)node[left,align=right]{load increment $\Delta\bs$\\$z$ decreases first\\then increases};
    \end{tikzpicture}
    \caption{arbitrary loading direction with frozen plasticity}\label{fig:loading_criterion}
\end{figure}

In the trial state, by freezing plasticity, viz., $H$, $F$, $\balpha$ and $\bd$ are all kept constant, it can be concluded that the centre of the subloading surface must lie on the line defined by centre of the yield surface $\bbeta$ and the similarity centre $\bc=\bbeta+F\bd$.
Then, for a given load increment $\Delta\bs=\bs_{n+1}-\bs_n$, assuming proportional loading, there exists a scalar $r$ such that the corresponding stress state $\bs_n+r\Delta\bs$ would minimise $z$, we denote this $z$ as $z^\text{trial}$ since it is computed in the trial state.
In mathematical terms, it can be expressed as
\begin{gather}
    \boxed{\min\limits_{r\in\mathbb{R}}z^\text{trial}\qquad\text{s.t.}\qquad{}f_s^\text{trial}\left(z^\text{trial},r\right)=0,}
\end{gather}
where $z^\text{trial}$ shall be computed by enforcing the corresponding $f_s^\text{trial}=0$.
% \begin{gather}\label{eq:trial_criterion}
%     \begin{split}
%         f_s^\text{trial} & =\norm{\beeta^\text{trial}}-z^\text{trial}F_n                                                 \\
%                          & =\norm{\bs_n+r\Delta\bs-H_n\balpha_n+\left(z^\text{trial}-1\right)F_n\bd_n}-z^\text{trial}F_n \\
%                          & =\norm{\bar{\beeta}+z^\text{trial}F_n\bd_n}-z^\text{trial}F_n                                 \\
%                          & =0,
%     \end{split}
% \end{gather}
% in which $\bar{\beeta}=\bar{\beeta}\left(r\right)=\bs_n-H_n\balpha_n-F_n\bd_n+r\Delta\bs$.
% The subscript $\left(\cdot\right)_n$ denotes the converged state at the beginning of the current loading step.
Since no extra constraints are imposed on $r$ for the moment, a solution is guaranteed to exist.
However, there are three distinctive cases.
\begin{enumerate}
    \item If $0<r<1$, the given load increment $\Delta\bs$ contains both elastic unloading and plastic loading.
          Since the elastic unloading portion ($0\to{}r$) reduces $z$ to a value smaller than the converged $z_n$, the plastic loading portion ($r\to{}1$) shall use this minimum $z$ (smaller than $z_n$, not necessarily zero in 3D models), instead of $z_n$, as the starting value to correctly compute plasticity development.
    \item If $r\geqslant1$, the given load increment $\Delta\bs$ involves only elastic unloading.
    \item If $r\geqslant0$, it is a pure loading case. Nothing additional needs to be done. $z_n$ is the correct starting value for return mapping.
\end{enumerate}
Thus, for any given load increment, one could 1) find the corresponding scalar $r$ that minimises $z^\text{trial}$, 2) use the above criteria to determine whether plasticity occurs, if so, also correct the starting value of $z$ if necessary.
We defer the presentation of explicit expressions for the above procedure after introducing the von Mises framework.
\subsection{A von Mises Model for Metals}
\subsubsection{Subloading Surface}
For the von Mises criterion, $\bs$ shall take the deviatoric part of the stress tensor $\bs=\dev{\bsigma}$, then
\begin{gather}
    \beeta=\dev{\bsigma}-H\balpha+\left(z-1\right)F\bd.
\end{gather}
The subloading surface shall be expressed as follows by replacing $F$ with $\sqrt{\dfrac{2}{3}}\sigma^y$.
\begin{gather}\label{eq:mises_subloading_surface}
    f_s=\norm{\beeta}-z\sqrt{\dfrac{2}{3}}\sigma^y.
\end{gather}
\subsubsection{Flow Rule}
Assuming associative plasticity, the flow rule is given by
\begin{gather}\label{eq:subloading_flow}
    \dot{\bvarepsilon^p}=\gamma\pdfrac{f_s}{\bsigma}=\gamma\dfrac{\beeta}{\norm{\beeta}}=\gamma\bn,
\end{gather}
where $\gamma$ denotes the plastic multiplier.
\subsubsection{Evolution Rules}
\paragraph{Accumulated Plastic Strain}
The accumulated plastic strain $q$ simply takes the accumulated magnitude of $\bvarepsilon^p$, thus, its rate form is
\begin{gather}\label{eq:eqv_strain}
    \dot{q}=\sqrt{\dfrac{2}{3}}\norm{\dot{\bvarepsilon^p}}=\sqrt{\dfrac{2}{3}}\gamma.
\end{gather}
\paragraph{Isotropic Hardening}
The evolution of $\sigma^y$ depends on $q$, here we adopt general form that combines linear hardening and nonlinear saturation.
\begin{gather}\label{eq:iso_bone}
    \sigma^y=\sigma^i+k_\text{iso}q+\sigma^s_\text{iso}\left(1-e^{-m^s_\text{iso}q}\right),
\end{gather}
where $\sigma^i$ is the initial yield stress, $k_\text{iso}$ is the isotropic hardening modulus, $\sigma^s_\text{iso}$ is the saturation stress, and $m^s_\text{iso}$ is the saturation rate.
\paragraph{Kinematic Hardening}
The kinematic hardening bound $H$ is replaced with a discrete function $a^y$ that takes a similar form to $\sigma^y$,
\begin{gather}\label{eq:kin_bone}
    a^y=a^i+k_\text{kin}q+a^s_\text{kin}\left(1-e^{-m^s_\text{kin}q}\right),
\end{gather}
where $a^i$ is the initial stress, $k_\text{kin}$ is the kinematic hardening modulus, $a^s_\text{kin}$ is the saturation stress, and $m^s_\text{kin}$ is the saturation rate.

The normalised back stress $\balpha$ adopts an Armstrong--Frederick type \cite{Frederick2007} evolution rule as shown in \eqsref{eq:revised_back}.
In this particular case, it shall be written as
\begin{gather}\label{eq:normalised_back_rule}
    \dot{\balpha}=b\left(\sqrt{\dfrac{2}{3}}\bn-\balpha\right)\gamma.
\end{gather}
It must be pointed out that, strictly speaking, \eqsref{eq:normalised_back_rule} shall be expressed as \cite{Simo1998}
\begin{gather}
    \dot{\balpha}=b\left(\dfrac{2}{3}\dot{\bvarepsilon^p}-\balpha\dot{q}\right)=b\sqrt{\dfrac{2}{3}}\left(\sqrt{\dfrac{2}{3}}\bn-\balpha\right)\gamma.
\end{gather}
With \eqsref{eq:normalised_back_rule}, the extra constant $\sqrt{\dfrac{2}{3}}$ is combined with the constant $b$ to make it a little more compact.
\paragraph{Elastic Core}
Similarly, the new field $\bd$ also adopts an Armstrong--Frederick type evolution rule as shown in \eqsref{eq:revised_core}.
\begin{gather}
    \dot{\bd}=c_e\left(\sqrt{\dfrac{2}{3}}z_e\bn-\bd\right)\gamma.
\end{gather}
\subsubsection{Summary}
The key expressions for both uniaxial and 3D models are summarised in \tabref{tab:summary}.
Note the constant $\sqrt{\dfrac{2}{3}}$ is added to the evolution rules for $\alpha$ and $d$ in the uniaxial version to ensure the same set of parameters used for both models would yield the same results.
They can be removed if such a consistency is not required.
\begin{table}[htb]
    \centering\footnotesize
    \caption{summary of the subloading surface model}\label{tab:summary}
    \begin{tabular}{rlll}
        \toprule
                           & uniaxial                                                                                                     & 3D                                                                 &              \\ \midrule
        Constitutive Law   & $\sigma=E\left(\varepsilon-\varepsilon^p\right)$                                                             & $\bsigma=\mb{D}_e:\left(\bvarepsilon-\bvarepsilon^p\right)$        &              \\
        Subloading Surface & $f_s=\abs{\eta}-z\sigma^y$                                                                                   & $f_s=\norm{\beeta}-z\sqrt{\dfrac{2}{3}}\sigma^y$                   &              \\
                           & $\eta=\sigma-a^y\alpha+\left(z-1\right)\sigma^yd$                                                            & $\beeta=\dev{\bsigma}-a^y\balpha+\left(z-1\right)\sigma^y\bd$      & \faLightbulb \\
        Flow Rule          & $\dot{\varepsilon^p}=\gamma{}n$                                                                              & $\dot{\bvarepsilon^p}=\gamma{}\bn$                                 &              \\
                           & $n=\sign{\eta}$                                                                                              & $\bn=\pdfrac{f_s}{\bsigma}/\norm{\pdfrac{f_s}{\bsigma}}$           &              \\
        Evolution Rules    & $\dot{q}=\gamma$                                                                                             & $\dot{q}=\sqrt{\dfrac{2}{3}}\gamma$                                &              \\
                           & $\dot{\alpha}=\sqrt{\dfrac{2}{3}}b\left(n-\alpha\right)\gamma$                                               & $\dot{\balpha}=b\left(\sqrt{\dfrac{2}{3}}\bn-\balpha\right)\gamma$ & \faLightbulb \\
                           & $\dot{d}=\sqrt{\dfrac{2}{3}}c_e\left(z_en-d\right)\gamma$                                                    & $\dot{\bd}=c_e\left(\sqrt{\dfrac{2}{3}}z_e\bn-\bd\right)\gamma$    & \faLightbulb \\
                           & \multicolumn{2}{l}{$\dot{z}=U\dot{q}$}                                                                       &                                                                                   \\
                           & \multicolumn{2}{l}{$\sigma^y=\sigma^i+k_\text{iso}q+\sigma^s_\text{iso}\left(1-e^{-m^s_\text{iso}q}\right)$} &                                                                                   \\
                           & \multicolumn{2}{l}{$a^y=a^i+k_\text{kin}q+a^s_\text{kin}\left(1-e^{-m^s_\text{kin}q}\right)$}                &                                                                                   \\ \midrule
        \multicolumn{4}{l}{Items labelled by \faLightbulb{} are novel proposals compared to the existing formulation \cite{Hashiguchi2024}.}                                                                                  \\ \bottomrule
    \end{tabular}
\end{table}

For brevity, the Armstrong--Frederick evolution rule is used for $\balpha$ and $\bd$.
More complex definitions can be used if necessary.
The main takeaway is the proposed decomposition, namely \eqref{eq:decomposition_core} and \eqsref{eq:decomposition_back}.
It satisfies the enclosing/bounding condition as long as $\balpha$ and $\bd$ are bounded.
It allows simple and concise formulation that is beneficial for both theoretical interpretation and numerical implementation.
\subsection{Formulation}
\subsubsection{Trial State}
Similar to the conventional return mapping algorithm, the trial state is computed by assuming the given load increment is fully elastic, then one could compute the trial stress $\bsigma^\text{trial}$ via the constitutive law.
\begin{gather}
    \bsigma^\text{trial}=\bsigma_n+\mb{D}_e:\left(\bvarepsilon_{n+1}-\bvarepsilon_n\right)=\bsigma_n+\mb{D}_e:\Delta\bvarepsilon.
\end{gather}
The incremental of the deviatoric part $\bs^\text{trial}=\dev{\bsigma^\text{trial}}$ can be computed accordingly.
\begin{gather}
    \Delta\bs=\bs^\text{trial}-\bs_n=\dev{\bsigma^\text{trial}-\bsigma_n}=2G\cdot\dev{\Delta\bvarepsilon},
\end{gather}
where $G$ is the shear modulus.
\subsubsection{Loading/Unloading Criterion}
At the beginning of each load increment, accounting for \eqsref{eq:mises_subloading_surface} and $\bar{\beeta}=\bs_n-H_n\balpha_n-F_n\bd_n+r\Delta\bs$, noting that $f_s^\text{trial}=0$ implies
\begin{gather}
    \left(\bar{\beeta}+z^\text{trial}F_n\bd_n\right):\left(\bar{\beeta}+z^\text{trial}F_n\bd_n\right)=\dfrac{2}{3}\left(z^\text{trial}\right)^2F_n^2,
\end{gather}
which is effectively,
\begin{gather}
    \bar{\beeta}:\bar{\beeta}+2F_n\bar{\beeta}:\bd_nz^\text{trial}+F_n^2\left(\bd_n:\bd_n-\dfrac{2}{3}\right)\left(z^\text{trial}\right)^2=0.
\end{gather}
By the quadratic formula,
\begin{gather}\label{eq:z_trial}
    z^\text{trial}\left(r\right)=\dfrac{\bar{\beeta}:\bd_n+\sqrt{\left(\bar{\beeta}:\bd_n\right)^2+\left(\bar{\beeta}:\bar{\beeta}\right)\left(\dfrac{2}{3}-\bd_n:\bd_n\right)}}{F_n\left(\dfrac{2}{3}-\bd_n:\bd_n\right)}.
\end{gather}
Noting that $\norm{\bd_n}<\sqrt{\dfrac{2}{3}}z_e\leqslant\sqrt{\dfrac{2}{3}}$, then, $\dfrac{2}{3}-\bd_n:\bd_n>0$, thus, the denominator is positive.
Due to the same reason, $\sqrt{\left(\bar{\beeta}:\bd_n\right)^2+\left(\bar{\beeta}:\bar{\beeta}\right)\left(\dfrac{2}{3}-\bd_n:\bd_n\right)}>\abs{\bar{\beeta}:\bd_n}$.
The other root is discarded since it may be negative.

To minimise $z^\text{trial}$, which is a univariate function of $r$ in the trial state, one could derive
\begin{gather}
    \ddfrac{z^\text{trial}}{r}=0\quad\rightarrow\quad
    \ddfrac{}{r}\left(\bar{\beeta}:\bd_n+\sqrt{\left(\bar{\beeta}:\bd_n\right)^2+\left(\bar{\beeta}:\bar{\beeta}\right)\left(\dfrac{2}{3}-\bd_n:\bd_n\right)}\right)=0.
\end{gather}
Its explicit form can be further expressed as follows,
\begin{gather}
    \bd_n:\Delta\bs+\dfrac{\left(\bd_n:\bar{\beeta}\right)\left(\bd_n:\Delta\bs\right)+\left(\dfrac{2}{3}-\bd_n:\bd_n\right)\left(\bar{\beeta}:\Delta\bs\right)}{\sqrt{\left(\bd_n:\bar{\beeta}\right)^2+\left(\dfrac{2}{3}-\bd_n:\bd_n\right)\left(\bar{\beeta}:\bar{\beeta}\right)}}=0,
\end{gather}
which, in a general context, can be solved by the Newton--Raphson method.

Let $R_r$ denote the residual
\begin{multline}\label{eq:z_residual}
    R_r=\left(\bd_n:\Delta\bs\right)\sqrt{\left(\bd_n:\bar{\beeta}\right)^2+\left(\dfrac{2}{3}-\bd_n:\bd_n\right)\left(\bar{\beeta}:\bar{\beeta}\right)}\\
    +\left(\bd_n:\bar{\beeta}\right)\left(\bd_n:\Delta\bs\right)+\left(\dfrac{2}{3}-\bd_n:\bd_n\right)\left(\bar{\beeta}:\Delta\bs\right).
\end{multline}
It's derivative with regard to $r$ is
\begin{multline}\label{eq:z_derivative}
    J_r=\ddfrac{R_r}{r}=\left(\bd_n:\Delta\bs\right)\dfrac{\left(\bd_n:\bar{\beeta}\right)\left(\bd_n:\Delta\bs\right)+\left(\dfrac{2}{3}-\bd_n:\bd_n\right)\left(\bar{\beeta}:\Delta\bs\right)}{\sqrt{\left(\bd_n:\bar{\beeta}\right)^2+\left(\dfrac{2}{3}-\bd_n:\bd_n\right)\left(\bar{\beeta}:\bar{\beeta}\right)}}\\
    +\left(\bd_n:\Delta\bs\right)^2+\left(\dfrac{2}{3}-\bd_n:\bd_n\right)\left(\Delta\bs:\Delta\bs\right).
\end{multline}

Compared to the recent work \cite{Hashiguchi2018,Anjiki2019}, here we have presented an equivalent but simpler approach to compute the starting normal yield ratio for arbitrary loading increments.
\algoref{algo:loading_criterion} presents a general algorithm to detect partial elastic unloading and correct the starting value of the normal yield ratio if necessary.
\begin{breakablealgorithm}
    \caption{correct starting value of normal yield ratio $z$}\label{algo:loading_criterion}
    \begin{algorithmic}[1]
        \State \textbf{Input}: $\bsigma^\text{trial}$, $\bsigma_n$, $\balpha_{n}$, $\bd_n$, $q_n$, $z_n$
        \State \textbf{Output}: $r$
        \State compute $\Delta\bs=\bs^\text{trial}-\bs_n$ using $\bsigma^\text{trial}$ and $\bsigma_n$
        \State $r=0$
        \While{true}\Comment{perform line search}
        \State $\bar{\beeta}=\bs_n-H_n\balpha_n-F_n\bd_n+r\Delta\bs$
        \State formulate $R_r$ and $J_r$\Comment{\eqsref{eq:z_residual}, \eqsref{eq:z_derivative}}
        \State $\delta{}r=R_r/J_r$
        \If{$\abs{\delta{}r}<\text{tolerance}$}
        \If{$0<r<1$}\Comment{current loading increment contains elastic unloading}
        \State update $z_{n}=z^\text{trial}$\Comment{compute $z^\text{trial}$ using $r$ via \eqsref{eq:z_trial}}
        \EndIf
        \State \textbf{return} $r$
        \EndIf
        \State $r\leftarrow{}r-\delta{}r$
        \EndWhile
    \end{algorithmic}
\end{breakablealgorithm}
\subsubsection{Some Simplifications}
Noting that $\dot{\balpha}$ is a linear function of $\balpha$, taking advantage of the implicit Euler method, one could express $\balpha$ in its explicit form.
\begin{gather}\label{eq:explicit_alpha}
    \balpha_n+b\left(\sqrt{\dfrac{2}{3}}\bn-\balpha\right)\gamma=\balpha\qquad\rightarrow\qquad
    \balpha=\dfrac{\gamma\sqrt{\dfrac{2}{3}}b\bn+\balpha_n}{1+\gamma{}b}.
\end{gather}
Similarly, $\bd$ can be expressed as
\begin{gather}\label{eq:explicit_d}
    \bd_n+c_e\left(\sqrt{\dfrac{2}{3}}z_e\bn-\bd\right)\gamma=\bd\qquad\rightarrow\qquad\bd=\dfrac{\gamma{}\sqrt{\dfrac{2}{3}}c_ez_e\bn+\bd_n}{1+\gamma{}c_e}.
\end{gather}
On the other hand, the deviatoric stress $\bs$ shall be computed via the trial stress $\bsigma^\text{trial}$,
\begin{gather}
    \bs=\dev{\bsigma}=\dev{\bsigma^\text{trial}-\gamma2G\bn}=\dev{\bsigma^\text{trial}}-\gamma2G\bn=\bs^\text{trial}-\gamma2G\bn.
\end{gather}

The shifted stress $\beeta$ is then
\begin{gather}\label{eq:explicit_eta}
    \begin{split}
        \beeta & =\bs-a^y\balpha+\left(z-1\right)\sigma^y\bd                                                                                                                                                \\
               & =\bs^\text{trial}-\gamma2G\bn-a^y\dfrac{\gamma{}\sqrt{\dfrac{2}{3}}b\bn+\balpha_n}{1+\gamma{}b}+\left(z-1\right)\sigma^y\dfrac{\gamma{}\sqrt{\dfrac{2}{3}}c_ez_e\bn+\bd_n}{1+\gamma{}c_e}.
    \end{split}
\end{gather}
Rearranging gives
\begin{multline}
    \beeta+\gamma2G\bn+\sqrt{\dfrac{2}{3}}b\dfrac{\gamma{}a^y}{1+\gamma{}b}\bn+\sqrt{\dfrac{2}{3}}c_ez_e\left(1-z\right)\dfrac{\gamma{}\sigma^y}{1+\gamma{}c_e}\bn=\\\bs^\text{trial}-\dfrac{a^y}{1+\gamma{}b}\balpha_n+\left(z-1\right)\dfrac{\sigma^y}{1+\gamma{}c_e}\bd_n.
\end{multline}
One could denote the right hand side as
\begin{gather}\label{eq:zeta}
    \bzeta=\bs^\text{trial}-\dfrac{a^y}{1+\gamma{}b}\balpha_n+\left(z-1\right)\dfrac{\sigma^y}{1+\gamma{}c_e}\bd_n,
\end{gather}
such that
\begin{gather}
    \left(\norm{\beeta}+\gamma2G+\sqrt{\dfrac{2}{3}}b\dfrac{\gamma{}a^y}{1+\gamma{}b}+\sqrt{\dfrac{2}{3}}c_ez_e\left(1-z\right)\dfrac{\gamma{}\sigma^y}{1+\gamma{}c_e}\right)\bn=\bzeta.
\end{gather}
It can be noted that each term in the bracket is non-negative by definition, thus it is correct to conclude that
\begin{gather}\label{eq:zeta_norm}
    \norm{\beeta}+\gamma2G+\sqrt{\dfrac{2}{3}}b\dfrac{\gamma{}a^y}{1+\gamma{}b}+\sqrt{\dfrac{2}{3}}c_ez_e\left(1-z\right)\dfrac{\gamma{}\sigma^y}{1+\gamma{}c_e}=\norm{\bzeta},
\end{gather}
and
\begin{gather}
    \bn=\dfrac{\beeta}{\norm{\beeta}}=\dfrac{\bzeta}{\norm{\bzeta}}.
\end{gather}
The above simplifications are valid under the assumption of associative plasticity flow.
Although it is not possible to simplify more, one shall realise that $\bzeta$ is a function of $\bvarepsilon$, $\gamma$ and $z$ only.
Its derivatives can be computed as follows.
\begin{gather}\label{eq:zeta_d1}
    \pdfrac{\bzeta}{\gamma}=-\dfrac{\ddfrac{a^y}{\gamma}\left(1+\gamma{}b\right)-ba^y}{\left(1+\gamma{}b\right)^2}\balpha_n+\left(z-1\right)\dfrac{\ddfrac{\sigma^y}{\gamma}\left(1+\gamma{}c_e\right)-c_e\sigma^y}{\left(1+\gamma{}c_e\right)^2}\bd_n,\\\label{eq:zeta_d2}
    \pdfrac{\bzeta}{z}=\dfrac{\sigma^y}{1+\gamma{}c_e}\bd_n,\\\label{eq:zeta_d3}
    \pdfrac{\bzeta}{\bvarepsilon}=2G\mathbb{I}^\text{dev}.
\end{gather}
\subsubsection{Local System}
The local system consists of two residuals, $f_s$ and $z$.
\begin{gather}
    \mb{R}=\left\{
    \begin{array}{l}
        \norm{\beeta}-\sqrt{\dfrac{2}{3}}z\sigma^y, \\[2mm]
        z-z_n-\sqrt{\dfrac{2}{3}}U\gamma.
    \end{array}
    \right.
\end{gather}
Taking the local variable as $\mb{x}=\begin{bmatrix}
        \gamma & z
    \end{bmatrix}^\mT$, the Jacobian $\mb{J}$ shall be written as
\begin{gather}
    \mb{J}=\begin{bmatrix}
        \pdfrac{\norm{\beeta}}{\gamma}-\sqrt{\dfrac{2}{3}}z\ddfrac{\sigma^y}{\gamma} & \pdfrac{\norm{\beeta}}{z}-\sqrt{\dfrac{2}{3}}\sigma^y \\[4mm]
        -\sqrt{\dfrac{2}{3}}U                                                        & 1-\sqrt{\dfrac{2}{3}}\gamma{}\ddfrac{U}{z}
    \end{bmatrix}.
\end{gather}
It is possible to avoid cumbersome computation of derivatives of $\norm{\beeta}$ by taking advantage of \eqsref{eq:zeta_norm}.
By noting that the derivatives of $\norm{\bzeta}$ can be further expanded as
\begin{gather}
    \pdfrac{\norm{\bzeta}}{}=\bn:\pdfrac{\bzeta}{},
\end{gather}
then
\begin{gather}\label{eq:eta_d1}
    \pdfrac{\norm{\beeta}}{\gamma}=\bn:\pdfrac{\bzeta}{\gamma}-2G-\pdfrac{}{\gamma}\left(\sqrt{\dfrac{2}{3}}b\dfrac{\gamma{}a^y}{1+\gamma{}b}+\sqrt{\dfrac{2}{3}}c_ez_e\left(1-z\right)\dfrac{\gamma{}\sigma^y}{1+\gamma{}c_e}\right),\\\label{eq:eta_d2}
    \pdfrac{\norm{\beeta}}{z}=\bn:\pdfrac{\bzeta}{z}+\sqrt{\dfrac{2}{3}}c_ez_e\dfrac{\gamma{}\sigma^y}{1+\gamma{}c_e}.
\end{gather}
\subsubsection{Consistent Tangent Operator}
It is possible to differentiate the local equilibrium $\mb{R}=\mb{0}$ to obtain
\begin{gather}
    \pdfrac{\mb{R}}{\bvarepsilon}+\pdfrac{\mb{R}}{\mb{x}}\ddfrac{\mb{x}}{\bvarepsilon}=\mb{0}.
\end{gather}
This gives
\begin{gather}\label{eq:local_equilibrium}
    \ddfrac{\mb{x}}{\bvarepsilon}=-\left(\pdfrac{\mb{R}}{\mb{x}}\right)^{-1}\pdfrac{\mb{R}}{\bvarepsilon}=-\mb{J}^{-1}\pdfrac{\mb{R}}{\bvarepsilon}.
\end{gather}
Noting that
\begin{gather}
    \pdfrac{\norm{\beeta}}{\bvarepsilon}=\bn:\pdfrac{\bzeta}{\bvarepsilon}=2G\bn:\mathbb{I}^\text{dev}=2G\bn,
\end{gather}
then in the matrix form,
\begin{gather}
    \pdfrac{\mb{R}}{\bvarepsilon}=2G\begin{bmatrix}
        \bn^\mT \\\mb{0}
    \end{bmatrix}.
\end{gather}
By solving \eqsref{eq:local_equilibrium}, one could obtain $\ddfrac{\mb{x}}{\bvarepsilon}$, we are interested in the first row, which can be explicitly written as
\begin{gather}
    \ddfrac{\gamma}{\bvarepsilon}=-2G\dfrac{1-\sqrt{\dfrac{2}{3}}\gamma{}\ddfrac{U}{z}}{\det\mb{J}}\bn^\mT.
\end{gather}
Now from the stress update expression $\bsigma=\bsigma^\text{trial}-\gamma2G\bn$, it is possible to derive the consistent tangent operator as
\begin{gather}
    \ddfrac{\bsigma}{\bvarepsilon}=\mb{D}_e-2G\left(\pdfrac{\bn}{\bvarepsilon}\gamma+\bn\ddfrac{\gamma}{\bvarepsilon}\right),
\end{gather}
where $\mb{D}_e$ is the elastic stiffness.
In the meantime, by $\bn=\dfrac{\bzeta}{\norm{\bzeta}}$, the derivative of $\bn$ with respect to $\bvarepsilon$ can be shown as
\begin{gather}
    \pdfrac{\bn}{\bvarepsilon}=\dfrac{2G}{\norm{\bzeta}}\left(\mathbb{I}^\text{dev}-\bn\otimes\bn\right),
\end{gather}
after some algebra, the consistent tangent operator can be written as
\begin{gather}\label{eq:consistent_tangent}
    \ddfrac{\bsigma}{\bvarepsilon}=\mb{D}_e-\dfrac{4G^2\gamma}{\norm{\bzeta}}\mathbb{I}^\text{dev}+4G^2\left(\dfrac{\gamma}{\norm{\bzeta}}+\dfrac{1-\sqrt{\dfrac{2}{3}}\gamma{}\ddfrac{U}{z}}{\det\mb{J}}\right)\bn\otimes\bn.
\end{gather}
It is a symmetric tensor/matrix.
One can also observe some resemblance between \eqsref{eq:j2_stiffness} and \eqsref{eq:consistent_tangent}.
\subsection{Implementation}
The complete algorithm is presented in \algoref{algo:subloading_steel}.
It adopts a standard Newton--Raphson scheme (implicit, closest point projection) to solve the local equilibrium.
Noting that the local iteration does not involve complex tensor algebra, the algorithm can be implemented in a very efficient and concise manner.
\begin{breakablealgorithm}
    \caption{state determination of the subloading surface model}\label{algo:subloading_steel}
    \begin{algorithmic}[1]
        \State \textbf{Parameter}: $E$, $\nu$, $\sigma^i$, $k_\text{iso}$, $\sigma^s_\text{iso}$, $m^s_\text{iso}$, $a^i$, $k_\text{kin}$, $a^s_\text{kin}$, $m^s_\text{kin}$, $b$, $u$, $c_e$, $z_e$
        \State \textbf{Input}: $\bvarepsilon_{n+1}$, $\bvarepsilon_n$, $\bsigma_n$, $\balpha_{n}$, $\bd_n$, $q_n$, $z_n$
        \State \textbf{Output}: $\mb{D}_{n+1}$, $\bsigma_{n+1}$, $\balpha_{n+1}$, $\bd_{n+1}$, $q_{n+1}$, $z_{n+1}$
        \State compute trial stress $\bsigma^\text{trial}=\bsigma_n+\mb{D}_e\left(\bvarepsilon_{n+1}-\bvarepsilon_n\right)$\Comment{$\mb{D}_e$: elastic stiffness}
        \State set history variables $\left(\cdot\right)_{n+1}=\left(\cdot\right)_{n}$ for $\balpha_{n+1}$, $\bd_{n+1}$, $q_{n+1}$, $z_{n+1}$
        \State check loading criterion\Comment{\algoref{algo:loading_criterion}}
        \If{$r\geqslant1$}\Comment{elastic unloading}
        \State $\bsigma_{n+1}=\bsigma^\text{trial}$
        \State $\mb{D}_{n+1}=\mb{D}_e$
        \State update $z$ by solving $\norm{\bs_{n+1}-a^y_{n+1}\balpha_{n+1}+\left(z-1\right)\sigma^y_{n+1}\bd_{n+1}}=\sqrt{\dfrac{2}{3}}z\sigma^y_{n+1}$\Comment{$0\leqslant{}z\leqslant1$}
        \State \textbf{return}
        \EndIf
        \State $\gamma=0$\Comment{plastic multiplier}
        \While{true}
        \State update $q_{n+1}$ according to $\gamma$\Comment{\eqsref{eq:eqv_strain}}
        \State update $a^y_{n+1}$ and $\sigma^y_{n+1}$ according to $q_{n+1}$\Comment{\eqsref{eq:iso_bone}, \eqsref{eq:kin_bone}}
        \State compute $\bzeta_{n+1}$ and $\bn_{n+1}$\Comment{\eqsref{eq:zeta}}
        \State update $\balpha_{n+1}$, $\bd_{n+1}$\Comment{\eqsref{eq:explicit_alpha}, \eqsref{eq:explicit_d}}
        \State formulate $\mb{R}$\Comment{$\norm{\beeta}$ can be directly computed using \eqsref{eq:explicit_eta}}
        \State formulate $\mb{J}$\Comment{\eqsref{eq:eta_d1} via \eqsref{eq:zeta_d1}, \eqsref{eq:eta_d2} via \eqsref{eq:zeta_d2}}
        \State $\Delta=\mb{J}^{-1}\mb{R}$\Comment{$\Delta=\begin{bmatrix}\delta\gamma&\delta{}z\end{bmatrix}$}
        \If{$\norm{\Delta}<\text{tolerance}$}
        \State compute stress $\bsigma_{n+1}=\bsigma^\text{trial}-\gamma2G\bn_{n+1}$\Comment{$G$: shear modulus}
        \State compute consistent tangent stiffness $\mb{D}_{n+1}$\Comment{\eqsref{eq:consistent_tangent}}
        \State \textbf{return}
        \EndIf
        \State $\gamma\leftarrow\gamma-\delta\gamma$
        \State $z\leftarrow{}z-\delta{}z$
        \EndWhile
    \end{algorithmic}
\end{breakablealgorithm}

The following is a reference implementation in CPP.
One shall note the alternative formulation presented in \tabref{tab:summary_alternative} is implemented.
\begin{cppcode}
    Subloading::update_trial_status
\end{cppcode}
\subsubsection{Remarks}
Compared to the previous implementation \cite{Fincato2017,Anjiki2019}, the formulation proposed in this work dramatically reduces the size of the local system from \num{20} to \num{2}.
We also present the explicit expression of the consistent tangent operator, which is not available in the previous works.
If \eqsref{eq:original_z} can be explicitly integrated by choosing a specific function $U$ (such as the cotangent function used in the original proposal), the local system can be further reduced to a scalar residual.
\subsection{Further Discussions}
One may have observed that the subtle difference between the uniaxial and multiaxial formulations lies in the scaling factor $\sqrt{\dfrac{2}{3}}$.
Accounting for this factor scattered here and there would be cumbersome and error-prone thus requires excessive attention.
Is there an alternative approach that may avoid this issue?
In this section, we explore a possible solution that may better align the uniaxial and multiaxial formulations.

Now since we have introduced the split (e.g., \eqsref{eq:decomposition_back}) that accounts for magnitude and direction separately, we shall further consider additional tweaks.
Again, let's revisit the ODE \eqsref{eq:af_ode} with both $a$ and $b$ being constants,
\begin{gather}
    y'=b(a-y).
\end{gather}
For trivial initial condition, the solution is, as stated earlier,
\begin{gather}
    y(x)=a\left(1-\exp\left(-bx\right)\right).
\end{gather}
It can be observed that it consists of two parts: 1) a scaling bound $a$, and 2) a saturation part that ranges from \num{0} to \num{1}.
One can easily arrive at the conclusion that such a function can be equivalently expressed as
\begin{gather}
    y=a\bar{y},\qquad\text{with}\qquad\bar{y}'=b(1-\bar{y}).
\end{gather}
What does it mean?
It means that for any non-unit bound $a$, one can extract it from the governing ODE, making the saturation part always have a unit bound.

Now consider both \eqsref{eq:decomposition_back} and \eqsref{eq:normalised_back_rule}, what we have at hand is essentially a tensor $\bbeta$ being expressed as a product of a scalar $H$ and a tensor $\balpha$.
This tensor $\balpha$, however, is not a unit tensor, its saturated value is $\sqrt{\dfrac{2}{3}}$ in the 3D formulation.
Since we already ave the scalar $H$, applying the above idea, we can formulate the evolution rule for $\bbeta$ as follows for 3D case,
\begin{gather}
    \boxed{\bbeta=\sqrt{\dfrac{2}{3}}H\balpha,}
\end{gather}
with
\begin{gather}
    \boxed{\dot{\balpha}=b\left(\bn-\balpha\right)\dot{q}.}
\end{gather}
Effectively, instead of scaling $\balpha$, we scale $H$.
It is much simpler to do so as the only change is to premultiply $H$ by the constant $\sqrt{\dfrac{2}{3}}$.

The previous formulation can now be equivalently rewritten as shown in \tabref{tab:summary_alternative}.
It is believed that this alternative formulation better unify the uniaxial and multiaxial cases with the minimum changes.
\begin{table}[htb]
    \centering\footnotesize\renewcommand{\arraystretch}{1.6}
    \caption{alternative formulation of the subloading surface model}\label{tab:summary_alternative}
    \begin{tabular}{rlll}
        \toprule
                           & uniaxial                                                                                 & 3D                                                            &              \\ \midrule
        Constitutive Law   & $\sigma=E\left(\varepsilon-\varepsilon^p\right)$                                         & $\bsigma=\mb{D}_e:\left(\bvarepsilon-\bvarepsilon^p\right)$   &              \\
        Subloading Surface & $f_s=\abs{\eta}-z\sigma^y$                                                               & $f_s=\norm{\beeta}-z\sigma^y$                                 &              \\
                           & $\eta=\sigma-a^y\alpha+\left(z-1\right)\sigma^yd$                                        & $\beeta=\dev{\bsigma}-a^y\balpha+\left(z-1\right)\sigma^y\bd$ & \faLightbulb \\
        Flow Rule          & $\dot{\varepsilon^p}=\gamma{}n$                                                          & $\dot{\bvarepsilon^p}=\gamma{}\bn$                            &              \\
                           & $n=\sign{\eta}$                                                                          & $\bn=\pdfrac{f_s}{\bsigma}/\norm{\pdfrac{f_s}{\bsigma}}$      &              \\
        Evolution Rules    & $\dot{q}=\gamma$                                                                         & $\dot{q}=\sqrt{\dfrac{2}{3}}\gamma$                           &              \\
                           & $\dot{\alpha}=b\left(n-\alpha\right)\dot{q}$                                             & $\dot{\balpha}=b\left(\bn-\balpha\right)\dot{q}$              & \faLightbulb \\
                           & $\dot{d}=c_e\left(z_en-d\right)\dot{q}$                                                  & $\dot{\bd}=c_e\left(z_e\bn-\bd\right)\dot{q}$                 & \faLightbulb \\
                           & $\sigma^y=\sigma^i+k_\text{iso}q+\sigma^s_\text{iso}\left(1-e^{-m^s_\text{iso}q}\right)$ & $\sigma^y\leftarrow\sqrt{\dfrac{2}{3}}\sigma^y$               &              \\
                           & $a^y=a^i+k_\text{kin}q+a^s_\text{kin}\left(1-e^{-m^s_\text{kin}q}\right)$                & $a^y\leftarrow\sqrt{\dfrac{2}{3}}a^y$                         &              \\                           & \multicolumn{2}{l}{$\dot{z}=U\dot{q}$}                                                   &                                                                              \\ \bottomrule
    \end{tabular}
\end{table}